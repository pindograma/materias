---
title: "Partidos em números: PCB e PC do B"
author: "João Costa"
date: "06/11/2020"
output:
  html_fragment:
    self_contained: false
---

```{r setup, include=FALSE}
library(sf)
library(tidyverse)
library(treemapify)
library(ggraph)
library(tidygraph)

load('./data/partidos_em_numeros.Rdata')
source('../theme.R')
pn = function(x) format(round(x, 2), big.mark = '.', decimal.mark = ',', nsmall = 0, digits = 2)

party <- "PC do B"
pcb <- "PCB"
cor <- filter(party_palette, party_name == party)$party_color
pcb_cor <- filter(party_palette, party_name == pcb)$party_color
cor_continua <- "YlOrRd"
pcb_cor_continua <- "Reds"
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```

Nesta edição do **Partidos em Números**, entenda por que o Brasil tem dois partidos comunistas e qual a diferença entre o Partido Comunista Brasileiro (PCB) e o Partido Comunista do Brasil (PCdoB).

---

#### História

O Partido Comunista é o partido brasileiro com a mais longa história, mesmo que interrompida por momentos de ilegalidade, perseguição e rachas. O PCB está presente na política brasileira desde março de 1922, quando foi fundado em Niterói, Rio de Janeiro.

Fundado como Partido Comunista – Seção Brasileira da Internacional Comunista, foi um dos únicos partidos de esquerda da República Velha e o primeiro de relevância nacional. A repercussão da Revolução Russa de 1917 ajudou a disseminar no país o marxismo, que se tornou a ideologia oficial do partido. 

Em julho de 1922 já começaria seu primeiro período de ilegalidade, que duraria até 1927. Mesmo na ilegalidade, o partido cresceu em diferentes partes do país. Em 1930, o partido se opôs ao golpe que colocou Getúlio Vargas no poder por não ser um movimento revolucionário de massas. 

Os primeiros anos de Vargas no poder envolveram intensa atividade do partido e comunicação direta com a União Soviética, firmando o caráter [leninista](https://www.marxists.org/portugues/dicionario/verbetes/m/marxismo_leninismo.htm) da organização. Foi nesta época que atuaram célebres militantes como Olga Benário e seu companheiro Luís Carlos Prestes. Em 1935, o casal esteve envolvido na primeira tentativa de levante revolucionário do PCB, a Intentona Comunista. A repressão ao partido aumentou após o desastroso movimento e pouco depois, em 1937, o PCB voltaria à ilegalidade com a implantação da ditadura do Estado Novo.

Só em 1945 o partido retomou seu registro oficial. Nas eleições daquele ano, as primeiras desde o Golpe de 1930, o PCB elegeu Prestes como senador e 14 deputados federais. Foi o partido mais votado na Câmara Municipal do Rio de Janeiro à época.

O crescimento do partido após o fim do Estado Novo atraiu figuras ilustres a suas fileiras como Graciliano Ramos, Jorge Amado, Oscar Niemeyer e Caio Prado Júnior. Lideranças políticas como Carlos Marighella e João Amazonas também ganharam proeminência na legenda nesta época.

A legalidade duraria pouco. Em 1947, o TSE cassou o registro da legenda e o mandato de políticos comunistas foi suspenso em 1948. De volta à ilegalidade pela terceira vez, o PCB continuou suas atividades clandestinas em meio ao início da Guerra Fria. O governo brasileiro estreitava seus laços com os Estados Unidos e a ‘ameaça comunista’ crescia nos radares dos aparatos de repressão estatal. 

Em 1956, o processo de [desestalinização](http://www.bibliotecadigital.unicamp.br/document/?down=000942355) da União Soviética leva a rachas em grupos comunistas no mundo todo, inclusive no PCB. É então que começam a surgir os dois partidos que temos hoje.

Liderados pelos ex-deputados João Amazonas e Maurício Grabois, os dissidentes fundaram um novo partido em 1962, também de orientação marxista-leninista. O Partido Comunista do Brasil (PCdoB) diferenciava-se do Partido Comunista Brasileiro (PCB) — ainda liderado por Prestes — por ser adepto das teorias políticas de [Mao Tse-tung](https://www.marxists.org/portugues/dicionario/verbetes/m/mao_zedong.htm), líder comunista chinês. Ambas as legendas reivindicam o título de legítimos sucessores do Partido Comunista original.

Em seu VI Congresso, em 1967, o PCB decidiu se posicionar contra a luta armada à ditadura militar. A decisão — acompanhada pela expulsão de lideranças como Carlos Marighella — provocou ainda mais rachas no PCB, levando à formação de diversos grupos adeptos do uso político da violência como o Movimento Revolucionário Oito de Outubro (MR-8), o Partido Comunista Brasileiro Revolucionário (PCBR) e a Aliança Libertadora Nacional (ALN). Grupos como estes foram os principais focos das perseguições, torturas e assassinatos cometidas por agentes do Estado durante o período. 

Enquanto o PCB se fragmentava e seus líderes eram mortos ou exilados, o PCdoB se reestruturava para adequar-se ao modelo maoísta de organização partidária. Foi neste contexto que o PCdoB organizou, em 1969, a Guerrilha do Araguaia, que duraria 7 anos, levou à morte de diversos militantes do partido e, em última instância, levaria o partido a abandonar o maoísmo e adotar o [hoxhaismo](https://www.marxists.org/portugues/dicionario/verbetes/h/hoxha_enver.htm) albanês como linha doutrinária.

O início do processo de abertura da ditadura deu espaço a ambos os partidos para iniciarem sua reorganização visando o retorno à legalidade. Apesar do retorno de vários líderes exilados como Luís Carlos Prestes, o PCB enfrentou disputas internas e dificuldades de reorganização. Vários militantes abandonaram o partido e passaram a integrar novos partidos de esquerda que surgiam na época como [PT](https://pindograma.com.br/2020/10/27/pt.html), [PDT](https://pindograma.com.br/2020/11/14/pdt.html) e [PSB](https://pindograma.com.br/2020/11/23/psb.html). Enquanto isso, o PCdoB, que manteve-se sob a liderança de João Amazonas desde sua fundação, voltava a organizar-se em sindicatos e movimentos trabalhistas. 

Foi apenas em 1985, com o fim oficial do regime militar, que os partidos recuperaram seus registros no TSE. O PCdoB passou por reorganizações ideológicas, abandonando as pretensões revolucionárias mas mantendo seu nome e o [marxismo-leninismo](https://www.marxists.org/portugues/dicionario/verbetes/m/marxismo_leninismo.htm) como ideologia oficial. Já o PCB passou por mais mudanças. Em 1992, os rachas do partido chegaram ao seu ápice e a legenda foi declarada extinta por seus próprios membros. A extinção na realidade foi um processo de reorganização. O partido abandonou o marxismo e adotou um novo nome naquele congresso: o Partido Popular Socialista (PPS). O PPS, hoje Cidadania, é considerado pela Justiça Eleitoral o sucessor legal do antigo PCB, mas no ano seguinte à mudança de nome, militantes opostos às mudanças refundaram o Partido Comunista Brasileiro.

Hoje, o PCB segue se definindo como um partido marxista-leninista revolucionário e participa das eleições para difundir os ideais do partido e inspirar a consciência revolucionária das classes trabalhadoras. Em parte por este viés antissistêmico, tem pouco sucesso em eleições e não tem representantes eleitos. A legenda é presidida pelo secretário-geral Edmilson Costa e seu número nas urnas é 21.

O PCdoB, porém, esteve mais disposto a se engajar com a democracia liberal. Desde a redemocratização o partido elege parlamentares e representantes pelo país. Em 2002, foi aliado do PT na eleição presidencial e passou a integrar o governo. A legenda ainda “[guia-se pela teoria marxista-lenista](https://pcdob.org.br/apresentacao-do-partido/)”, mas abandonou as práticas revolucionárias e atua como uma força menor no campo da esquerda brasileira. Do partido destacam-se Manuela D’Ávila, vice de Fernando Haddad (PT) na campanha presidencial de 2018 e candidata a prefeita em Porto Alegre em 2020, Flávio Dino, governador do Maranhão e Luciana Santos, vice-governadora de Pernambuco e presidente do partido. Nas urnas, usa o número 65.

---

#### Filiados

```{r, fig.height=6, fig.width=9}
filiados <- filiacoes_total %>% filter(PARTIDO == party)
ggplot(filiados, aes(DATA, n, group = 1))+
  geom_line(color = cor, size = 2)+
  geom_point(color = cor, size = 2.5)+
#  coord_cartesian(ylim = c(1250000, 1500000))+
  scale_y_continuous(
    labels = scales::label_number(
      accuracy = 1, decimal.mark = ",", big.mark = "."
      )
  )+
  labs(
    title = str_c(party,"Número de filiados (2010 - 2019)",
                  sep = " - "),
    caption = "Fonte: TSE"
  )+
  theme_pindograma()+
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_blank() 
  )
```

```{r, fig.height=6, fig.width=9}
filiados_b <- filiacoes_total %>% filter(PARTIDO == pcb)
ggplot(filiados_b, aes(DATA, n, group = 1))+
  geom_line(color = pcb_cor, size = 2)+
  geom_point(color = pcb_cor, size = 2.5)+
#  coord_cartesian(ylim = c(1250000, 1500000))+
  scale_y_continuous(
    labels = scales::label_number(
      accuracy = 1, decimal.mark = ",", big.mark = "."
      )
  )+
  labs(
    title = str_c(pcb,"Número de filiados (2010 - 2019)",
                  sep = " - "),
    caption = "Fonte: TSE"
  )+
  theme_pindograma()+
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_blank() 
  )
```

O PCdoB é um partido médio que cresce de maneira típica, ou seja, mais antes de eleições municipais. 	

O gráfico de filiados do PCB, no entanto, não reflete com precisão a sua quantidade de membros. Como indica o [Manual de Organização Partidária](http://pcb.org.br/portal/docs/manual.html), o partido só filia seus militantes que concorrem a cargos eletivos. O partido não divulga o número de militantes que possui, porém pode se estimar que seja do tamanho de outros partidos pequenos. 

```{r, fig.height=6, fig.width=9}
idade_filiados <- filiacoes_idade %>% filter(PARTIDO == party) %>% 
  group_by(DATA) %>% mutate(total = sum(n), prop = n/total) %>% ungroup()
order_age <- c("16 a 24 anos", "25 a 34 anos","35 a 44 anos", "45 a 59 anos",
               "60 a 69 anos", "70 anos ou mais") %>% rev()
ggplot(idade_filiados,
       aes(DATA, prop, fill = factor(FAIXA,levels = order_age)))+
  scale_fill_manual(
    values = c(pg_orange, pg_blue, pg_green, 
               pg_yellow, pg_light_gray, "#F4Ac90")
    )+
  geom_area(stat="identity")+
  labs(
    fill = "Faixa etária",
    caption = "Fonte: TSE",
    title = str_c(party,"Composição etária dos filiados (2010 - 2019)",
                  sep = " - ")
  )+
  coord_cartesian(xlim = c(as.Date("2010-10-01"), as.Date("2018-12-01")))+
  theme_pindograma()+
  theme(axis.ticks.y = element_blank(),
        axis.text.y = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "bottom",
        legend.title = element_blank(),
        legend.text = element_text(size = 12),
        panel.background = element_blank())
```

```{r, fig.height=6, fig.width=9}
idade_filiados_b <- filiacoes_idade %>% filter(PARTIDO == pcb) %>% 
  group_by(DATA) %>% mutate(total = sum(n), prop = n/total) %>% ungroup()
order_age <- c("16 a 24 anos", "25 a 34 anos","35 a 44 anos", "45 a 59 anos",
               "60 a 69 anos", "70 anos ou mais") %>% rev()
ggplot(idade_filiados_b,
       aes(DATA, prop, fill = factor(FAIXA,levels = order_age)))+
  scale_fill_manual(
    values = c(pg_orange, pg_blue, pg_green, 
               pg_yellow, pg_light_gray, "#F4Ac90")
    )+
  geom_area(stat="identity")+
  labs(
    fill = "Faixa etária",
    caption = "Fonte: TSE",
    title = str_c(pcb,"Composição etária dos filiados (2010 - 2019)",
                  sep = " - ")
  )+
  coord_cartesian(xlim = c(as.Date("2010-10-01"), as.Date("2018-12-01")))+
  theme_pindograma()+
  theme(axis.ticks.y = element_blank(),
        axis.text.y = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "bottom",
        legend.title = element_blank(),
        legend.text = element_text(size = 12),
        panel.background = element_blank())
```

O PCdoB é um partido ligeiramente mais velho que a média das legendas brasileiras. Apenas cerca de 16% de seus filiados têm menos de 34 anos.

Como citado acima, os dados de filiação do PCB não refletem o partido como um todo e sim seus membros que se candidatam. Em geral, esses membros são mais velhos, tendo entre 35 e 59 anos.

```{r, fig.height=6, fig.width=9}
sexo_filiados <- sexo %>% filter(PARTIDO == party)
ggplot(sexo_filiados, aes(factor(ANO), PROP_F_DEC, group = 1))+
  geom_col(fill = cor)+
  geom_text(
    aes(label = scales::percent(PROP_F_DEC, accuracy = 0.1, decimal.mark = ",")),
    vjust = 2,
    family = "Fantasque",
    size = 5
    )+
  theme_pindograma()+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party,"Proporção de mulheres filiadas (2008 - 2020)",
                  sep = " - ")
    )+
  coord_cartesian(ylim = c(.37,.49))+
  theme(
    axis.text.y = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.y = element_blank(),
    axis.title.x = element_blank()
    )
```

```{r, fig.height=6, fig.width=9}
sexo_filiados_b <- sexo %>% filter(PARTIDO == pcb)
ggplot(sexo_filiados_b, aes(factor(ANO), PROP_F_DEC, group = 1))+
  geom_col(fill = pcb_cor)+
  geom_text(
    aes(label = scales::percent(PROP_F_DEC, accuracy = 0.1, decimal.mark = ",")),
    vjust = 2,
    family = "Fantasque",
    size = 5
    )+
  theme_pindograma()+
  labs(
    caption = "Fonte: TSE",
    title = str_c(pcb,"Proporção de mulheres filiadas (2008 - 2020)",
                  sep = " - ")
    )+
  coord_cartesian(ylim = c(.37,.49))+
  theme(
    axis.text.y = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.y = element_blank(),
    axis.title.x = element_blank()
    )
```

Apesar da política de filiação, o PCB segue um padrão similar a grandes partidos quando se trata da proporção de mulheres. O número gira em torno de 45% e nos últimos anos aumentou. A proporção de mulheres no PCdoB é similar. 

```{r, fig.height=7, fig.width=9}
estado_filiados <- filiacao_estados %>% filter(PARTIDO == party) %>% 
  right_join(geoloc_states, by = 'UF')
ggplot(data = estado_filiados, aes(geometry = geom))+
  geom_sf(
          aes(fill = PROP_100K)
          )+
  scale_fill_fermenter(
    breaks = c(200, 400, 600, 800),
    palette = cor_continua, direction = 1
    )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party, "Filiados a cada 100 mil eleitores por estado",
                  sep = " - "),
    fill = ""
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.background = element_blank()
  )
```

```{r, fig.height=7, fig.width=9}
estado_filiados_b <- filiacao_estados %>% filter(PARTIDO == pcb) %>% 
  right_join(geoloc_states, by = 'UF')
ggplot(data = estado_filiados_b, aes(geometry = geom))+
  geom_sf(
          aes(fill = PROP_100K)
          )+
  scale_fill_fermenter(
    palette = pcb_cor_continua, direction = 1
    )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(pcb, "Filiados a cada 100 mil eleitores por estado",
                  sep = " - "),
    fill = ""
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.background = element_blank()
  )
```

O PCdoB tem a maior proporção de filiados no Amazonas e no Acre. Em seguida vem o Maranhão, onde o partido tem mais força. De resto, outros estados da região Nordeste concentram mais membros do PCdoB que estados de outras regiões.

Os filiados oficiais do PCB estão mais concentrados na região Norte e em parte do Nordeste, mas isso se deve principalmente às menores populações nessas regiões do que à força do partido: os números absolutos são baixos em todos os estados da Federação. 

A título de comparação, o estado com maior concentração de filiados ao PCB é o Sergipe, com 50 filiados a cada 100 mil eleitores – menos da metade da concentração de filiados ao PCdoB no Mato Grosso, o estado de menor concentração do partido.

---

#### Financiamento

```{r, fig.height=6, fig.width=9}
fundo <- fundo_partidario %>% filter(PARTIDO == party)
ggplot(fundo, aes(factor(ANO), VALOR_CORRIGIDO))+
  geom_col(fill = cor)+
  scale_y_continuous(
    labels = scales::label_number_si(
      prefix = "R$", big.mark = ".", decimal.mark = ","
      )
    )+
  geom_line(aes(y = 750000000*PROPORCAO), group = 1, color = pg_dark_gray, size = 1.5)+
  geom_point(aes(y = 750000000*PROPORCAO), color = pg_dark_gray, size = 2)+
  coord_cartesian(ylim = c(0, 25000000))+
  geom_text(
    aes(
      y = 750000000*PROPORCAO,
      label = scales::percent(
      PROPORCAO, accuracy = 0.1, big.mark = ".", decimal.mark = ","
      )),
    color = "grey20",
    family = "Fantasque",
    fontface = "bold",
    vjust = -1.5
    )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party,"Fundo partidário (2008-2019)",
                  sep = " - "),
    subtitle = "Linha cinza representa a proporção do valor total distribuído no ano
Valores em milhões de reais, corrigidos pela inflação"
  )+
  theme_pindograma()+
  theme(
    axis.text.x = element_text(size = 12),
    axis.text.y = element_text(size = 12),
    axis.title.x = element_blank(),
    plot.subtitle = element_text(hjust = .5),
    axis.title.y = element_blank()
  )
```

```{r, fig.height=6, fig.width=9}
fundo_b <- fundo_partidario %>% filter(PARTIDO == pcb)
ggplot(fundo_b, aes(factor(ANO), VALOR_CORRIGIDO))+
  geom_col(fill = pcb_cor)+
  scale_y_continuous(
    labels = scales::label_number_si(
      prefix = "R$", big.mark = ".", decimal.mark = ","
      )
    )+
  geom_line(aes(y = 750000000*PROPORCAO), group = 1, color = pg_dark_gray, size = 1.5)+
  geom_point(aes(y = 750000000*PROPORCAO), color = pg_dark_gray, size = 2)+
  coord_cartesian(ylim = c(0, 25000000))+
  geom_text(
    aes(
      y = 750000000*PROPORCAO,
      label = scales::percent(
      PROPORCAO, accuracy = 0.1, big.mark = ".", decimal.mark = ","
      )),
    color = "grey20",
    family = "Fantasque",
    fontface = "bold",
    vjust = -1.5
    )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(pcb,"Fundo partidário (2008-2019)",
                  sep = " - "),
    subtitle = "Linha cinza representa a proporção do valor total distribuído no ano
Valores em milhões de reais, corrigidos pela inflação"
  )+
  theme_pindograma()+
  theme(
    axis.text.x = element_text(size = 12),
    axis.text.y = element_text(size = 12),
    axis.title.x = element_blank(),
    plot.subtitle = element_text(hjust = .5),
    axis.title.y = element_blank()
  )
```

Desde de 2014 a quantidade de dinheiro recebida pelo PCdoB vem diminuindo. O partido ainda recebe uma quantidade pequena dos fundos distribuídos pelo TSE.

Enquanto isso, o PCB sempre recebeu o mínimo alocado a cada partido pelo Fundo Partidário. Em 2018, o partido não atingiu a cláusula de barreira estabelecida pela Emenda Constitucional nº 97/2017 e assim ficou sem fundos públicos em 2019 e 2020. 

Os partidos receberam R$ 30.941.860,30 e R$ 1.233.305,95, respectivamente, do Fundo Eleitoral para as eleições municipais de 2020.

---

#### Eleições 2020

```{r, fig.height=7, fig.width=9}
prefeito <- cand20 %>%
  filter(PARTIDO == party, CARGO == "PREFEITO") %>% 
  right_join(geoloc_cities, by = c("UF", "MUNICIPIO")) %>% 
  mutate(result = ifelse(is.na(eleito), 0, ifelse(eleito == "Não eleito", -1, 1))) %>% 
  distinct(UF, MUNICIPIO, .keep_all = T)
ggplot()+
  geom_sf(data = prefeito,
          aes(geometry = geom, fill = factor(eleito, levels = c("Eleito","2º turno","Não eleito"))),
          lwd = 0)+
  geom_sf(data = geoloc_states, aes(geometry = geom),fill = NA, lwd = .25)+
  scale_fill_manual(values = c(cor, pg_yellow, pg_blue),
                    labels = c("Eleito","Segundo Turno", "Não eleito", "Sem candidato"),
                    na.value="grey90")+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party, "Desempenho dos candidatos a prefeito em 2020",
                  sep = " - "),
    fill = "Resultado"
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.background = element_blank()
  )
```

```{r, fig.height=7, fig.width=9}
prefeito_b <- cand20 %>%
  filter(PARTIDO == pcb, CARGO == "PREFEITO") %>% 
  right_join(geoloc_cities, by = c("UF", "MUNICIPIO")) %>% 
  mutate(result = ifelse(is.na(eleito), 0, ifelse(eleito == "Não eleito", -1, 1))) %>% 
  distinct(UF, MUNICIPIO, .keep_all = T)
ggplot()+
  geom_sf(data = prefeito_b,
          aes(geometry = geom, fill = factor(eleito, levels = c("Não eleito"))),
          lwd = 0)+
  geom_sf(data = geoloc_states, aes(geometry = geom),fill = NA, lwd = .25)+
  scale_fill_manual(values = c(pg_blue),
                    labels = c("Não eleito", "Sem candidato"),
                    na.value="grey90")+
  labs(
    caption = "Fonte: TSE",
    title = str_c(pcb, "Desempenho dos candidatos a prefeito em 2020",
                  sep = " - "),
    fill = "Resultado"
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.background = element_blank()
  )
```

O PCdoB lançou 257 candidatos a prefeito em 2020, a maioria no Maranhão, estado governado por Flávio Dino. Além do Maranhão, o partido concentrou candidaturas na Bahia. Quase todas as vitórias foram nestes 2 estados.

Já o PCB lançou 5 candidatos a prefeito neste ano, nas cidades de Betim e Ipatinga, Minas Gerais; Cabo de Santo Agostinho e Garanhuns, Pernambuco; e Imperatriz, Maranhão. Nenhum deles foi eleito.

```{r, fig.height=6, fig.width=9}
edges_l <- coligacoes %>%
  filter(PARTIDO == party) %>% 
  left_join(nodes, by = c("PARTIDO"="value")) %>% 
  rename(from = id, weight = n) %>% 
  left_join(nodes, by = c("LEGENDA"="value")) %>% 
  rename(to = id) %>% select(from, to, weight)
leader <- tbl_graph(nodes = nodes, edges = edges_l, directed = TRUE) %>% 
  mutate(
    degree = ifelse(value == party,
                    centrality_degree(weights = edges_l$weight, mode = "out"),
                    centrality_degree(weights = edges_l$weight, mode = "in")
                    ) 
  )
ggraph(leader, layout = "star", center = filter(nodes, value == party)$id) +
  geom_edge_link(aes(width = weight), alpha = 0.6, color = cor) + 
  scale_edge_width(range = c(0.2, 6))+
  geom_node_point(aes(color = value, size = degree)) +
  scale_color_manual(values = nodes$party_color, guide = F) +
  geom_node_text(
    aes(label = ifelse(value==party, "", value)),
    nudge_y = .12,
    family = "Fantasque",
    fontface = "bold",
    size = 4,
    color = "grey10"
   )+
  scale_size(range = c(1, 20), guide = F)+
  labs(
    caption = "Fonte: TSE",
    title = str_c("Coligações nas eleições municipais de 2020 lideradas pelo", party,
                  sep = " "),
    edge_width = "Número de coligações"
  )+
  theme_pindograma()+
  theme(
    text = element_text(family = "Fantasque"),
    axis.line.x = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.x = element_blank(), 
    axis.ticks.y = element_blank(), 
    axis.text.x = element_blank(), 
    axis.text.y = element_blank(),
    panel.background = element_blank(),
    legend.position = "bottom"
    )
```

```{r, fig.height=6, fig.width=9}
edges_l_b <- coligacoes %>%
  filter(PARTIDO == pcb) %>% 
  left_join(nodes, by = c("PARTIDO"="value")) %>% 
  rename(from = id, weight = n) %>% 
  left_join(nodes, by = c("LEGENDA"="value")) %>% 
  rename(to = id) %>% select(from, to, weight)
leader_b <- tbl_graph(nodes = nodes, edges = edges_l_b, directed = TRUE) %>% 
  mutate(
    degree = ifelse(value == pcb,
                    centrality_degree(weights = edges_l_b$weight, mode = "out"),
                    centrality_degree(weights = edges_l_b$weight, mode = "in")
                    ) 
  )
ggraph(leader_b, layout = "star", center = filter(nodes, value == pcb)$id) +
  geom_edge_link(aes(width = weight), alpha = 0.6, color = pcb_cor) + 
  scale_edge_width(range = c(0.2, 6))+
  geom_node_point(aes(color = value, size = degree)) +
  scale_color_manual(values = nodes$party_color, guide = F) +
  geom_node_text(
    aes(label = ifelse(value==pcb, "", value)),
    nudge_y = .12,
    family = "Fantasque",
    fontface = "bold",
    size = 4,
    color = "grey10"
   )+
  scale_size(range = c(1, 10), guide = F)+
  labs(
    caption = "Fonte: TSE",
    title = str_c("Coligações nas eleições municipais de 2020 lideradas pelo", pcb,
                  sep = " "),
    edge_width = "Número de coligações"
  )+
  theme_pindograma()+
  theme(
    text = element_text(family = "Fantasque"),
    axis.line.x = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.x = element_blank(), 
    axis.ticks.y = element_blank(), 
    axis.text.x = element_blank(), 
    axis.text.y = element_blank(),
    panel.background = element_blank(),
    legend.position = "bottom"
    )
```

O PCdoB é um típico partido brasileiro, se coligando com quase todas as legendas do país. O partido que mais apoiou o PCdoB foi o PT, seguido pelo PDT e o PP. 

O PCB recebeu apoio para apenas uma de suas candidaturas, do PSOL.

```{r, fig.height=6, fig.width=9}
edges_f <- coligacoes %>%
  filter(LEGENDA == party) %>% 
  left_join(nodes, by = c("PARTIDO"="value")) %>% 
  rename(from = id, weight = n) %>% 
  left_join(nodes, by = c("LEGENDA"="value")) %>% 
  rename(to = id) %>% select(from, to, weight)
follower <- tbl_graph(nodes = nodes, edges = edges_f, directed = TRUE) %>% 
  mutate(
    degree = ifelse(value == party,
                    centrality_degree(weights = edges_f$weight, mode = "in"),
                    centrality_degree(weights = edges_f$weight, mode = "out")
                    ) 
  )
ggraph(follower, layout = "star", center = filter(nodes, value == party)$id) +
  geom_edge_link(aes(width = weight), alpha = 0.6, color = cor) + 
  scale_edge_width(range = c(0.2, 6))+
  geom_node_point(aes(color = value, size = degree)) +
  scale_color_manual(values = nodes$party_color, guide = F) +
  geom_node_text(
    aes(label = ifelse(value==party, "", value)),
    nudge_y = .12,
    family = "Fantasque",
    fontface = "bold",
    size = 4,
    color = "grey10"
   )+
  scale_size(range = c(1, 30), guide = F)+
  labs(
    caption = "Fonte: TSE",
    title = str_c("Coligações nas eleições municipais de 2020 lideradas\npor outros partidos e integradas pelo", party,
                  sep = " "),
    edge_width = "Número de coligações"
  )+
  theme_pindograma()+
  theme(
    text = element_text(family = "Fantasque"),
    axis.line.x = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.x = element_blank(), 
    axis.ticks.y = element_blank(), 
    axis.text.x = element_blank(), 
    axis.text.y = element_blank(),
    panel.background = element_blank(),
    legend.position = "bottom"
    )
```

```{r, fig.height=6, fig.width=9}
edges_f_b <- coligacoes %>%
  filter(LEGENDA == pcb) %>% 
  left_join(nodes, by = c("PARTIDO"="value")) %>% 
  rename(from = id, weight = n) %>% 
  left_join(nodes, by = c("LEGENDA"="value")) %>% 
  rename(to = id) %>% select(from, to, weight)
follower_b <- tbl_graph(nodes = nodes, edges = edges_f_b, directed = TRUE) %>% 
  mutate(
    degree = ifelse(value == pcb,
                    centrality_degree(weights = edges_f_b$weight, mode = "in"),
                    centrality_degree(weights = edges_f_b$weight, mode = "out")
                    ) 
  )
ggraph(follower_b, layout = "star", center = filter(nodes, value == pcb)$id) +
  geom_edge_link(aes(width = weight), alpha = 0.6, color = pcb_cor) + 
  scale_edge_width(range = c(1, 6), label = c(2,16), breaks = c(2,16))+
  geom_node_point(aes(color = value, size = degree)) +
  scale_color_manual(values = nodes$party_color, guide = F) +
  geom_node_text(
    aes(label = ifelse(value==pcb, "", value)),
    nudge_y = .12,
    family = "Fantasque",
    fontface = "bold",
    size = 4,
    color = "grey10"
   )+
  scale_size(range = c(1, 20), guide = F)+
  labs(
    caption = "Fonte: TSE",
    title = str_c("Coligações nas eleições municipais de 2020 lideradas\npor outros partidos e integradas pelo", pcb,
                  sep = " "),
    edge_width = "Número de coligações"
  )+
  theme_pindograma()+
  theme(
    text = element_text(family = "Fantasque"),
    axis.line.x = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.x = element_blank(), 
    axis.ticks.y = element_blank(), 
    axis.text.x = element_blank(), 
    axis.text.y = element_blank(),
    panel.background = element_blank(),
    legend.position = "bottom"
    )
```

Em se tratando de apoiar outros partidos, o PT novamente é preferido. Já o PDT divide o segundo lugar com PSD, PSB, PP e MDB.

O PCB coligou-se apenas com o PSOL e a UP nas eleições de 2020.

```{r, fig.height=7, fig.width=9}
vereador <- cand20 %>%
  filter(PARTIDO == party, CARGO == "VEREADOR") %>% 
  group_by(UF, MUNICIPIO) %>%
  mutate(n = n(), n_elected = sum(eleito == "Eleito", na.rm = T)) %>% ungroup() %>% 
  right_join(geoloc_cities, by = c("UF", "MUNICIPIO")) %>% 
  mutate(candidatos = ifelse(is.na(CARGO), 0, n)) %>% 
  distinct(UF, MUNICIPIO, .keep_all = T)
ggplot()+
  geom_sf(data = vereador,
          aes(geometry = geom, fill = n_elected),
          lwd = 0)+
  geom_sf(data = geoloc_states, aes(geometry = geom),fill = NA, lwd=.25)+
  scale_fill_fermenter(
    breaks = c(1,2,5,10),
    palette = cor_continua, direction = 1
    )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party, "Vereadores eleitos por município em 2020",
                  sep = " - "),
    fill =  "Eleitos"
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.background = element_blank()
  )
```

```{r, fig.height=7, fig.width=9}
vereador_b <- cand20 %>%
  filter(PARTIDO == pcb, CARGO == "VEREADOR") %>% 
  group_by(UF, MUNICIPIO) %>%
  mutate(n = n(), n_elected = sum(eleito == "Eleito", na.rm = T)) %>% ungroup() %>% 
  right_join(geoloc_cities, by = c("UF", "MUNICIPIO")) %>% 
  mutate(candidatos = ifelse(is.na(CARGO), 0, n)) %>% 
  distinct(UF, MUNICIPIO, .keep_all = T)
ggplot()+
  geom_sf(data = vereador_b,
          aes(geometry = geom, fill = n),
          lwd = 0)+
  geom_sf(data = geoloc_states, aes(geometry = geom),fill = NA, lwd=.25)+
  scale_fill_fermenter(
    #breaks = c(1,2,5,10),
    palette = pcb_cor_continua, direction = 1
    )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(pcb, "Candidatos a vereador por município em 2020 (nenhum eleito)",
                  sep = " - "),
    fill =  "Candidatos\n(nenhum eleito)"
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.background = element_blank()
  )
```

O Maranhão e a Bahia foram os estados onde o PCdoB lançou mais candidatos a vereador e onde teve mais sucessos eleitorais. Em outros estados do Nordeste o sucesso foi mais limitado e, no resto do país, as vitórias foram pouquíssimas.

O PCB apresentou alguns candidatos a vereador em cerca de 20 municípios em 10 estados. Nenhum foi eleito.

```{r, fig.height=6, fig.width=9}
perfil_cand <- cand20 %>%
  filter(PARTIDO == party) %>% 
  group_by(RACA, GENERO) %>% summarize(n = n()) %>%
  mutate(GENERO = ifelse(GENERO == "FEMININO", "Mulheres", "Homens"))
ggplot(perfil_cand, aes(area = n, subgroup = GENERO, fill = RACA), layout = "srow")+
  geom_treemap(lwd = 3)+
  geom_treemap_subgroup_border(lwd = 6, colour = "white")+
  geom_treemap_subgroup_text(
    colour = "white",
    family = "Fantasque",
    place = "bottom",
    fontface = "bold",
    grow = FALSE,
    size = 22
  )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party, "Composição de sexo e raça dos candidatos em 2020",
                  sep = " - "),
    subtitle = "Área dos retângulos é proporcional à quantidade de candidatos",
    fill =  "Autodeclaração\nde cor ou raça"
  )+
  scale_fill_manual(
    values = c(pg_dark_gray, pg_green, pg_yellow, pg_blue, pg_orange, pg_light_gray),
    labels = c("Amarela", "Branca", "Indígena", "Parda", "Preta", "Sem informação")
    )+
  theme_pindograma()+
  theme(axis.line.x = element_blank())
```

```{r, fig.height=6, fig.width=9}
perfil_eleitos <- cand20 %>%
  filter(PARTIDO == party, eleito == "Eleito" | eleito == "2º turno") %>% 
  group_by(RACA, GENERO) %>% summarize(n = n()) %>%
  mutate(GENERO = ifelse(GENERO == "FEMININO", "Mulheres", "Homens"))
ggplot(perfil_eleitos, aes(area = n, subgroup = GENERO, fill = RACA), layout = "srow")+
  geom_treemap(lwd = 3)+
  geom_treemap_subgroup_border(lwd = 6, colour = "white")+
  geom_treemap_subgroup_text(
    colour = "white",
    family = "Fantasque",
    place = "bottom",
    fontface = "bold",
    grow = FALSE,
    size = 22
  )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party, "Composição de sexo e raça dos eleitos em 2020",
                  sep = " - "),
    subtitle = "Área dos retângulos é proporcional à quantidade de eleitos",
    fill =  "Autodeclaração\nde cor ou raça"
  )+
  scale_fill_manual(
    values = c(pg_dark_gray, pg_green, pg_yellow, pg_blue, pg_orange, pg_light_gray),
    labels = c("Amarela", "Branca", "Indígena", "Parda", "Preta", "Sem informação")
    )+
  theme_pindograma()+
  theme(axis.line.x = element_blank())
```

Tanto as candidaturas quanto os eleitos do PCdoB se destacam dentre os outros partidos brasileiros por ser de maioria parda. Pretos e pardos representam dois terços dos candidatos e 69,5% dos eleitos. No quesito de gênero, o PCdoB ainda tem um viés masculino: 65.7% dos candidatos e 82% dos eleitos são homens.

```{r, fig.height=6, fig.width=9}
perfil_cand_b <- cand20 %>%
  filter(PARTIDO == pcb) %>% 
  group_by(RACA, GENERO) %>% summarize(n = n()) %>%
  mutate(GENERO = ifelse(GENERO == "FEMININO", "Mulheres", "Homens"))
ggplot(perfil_cand_b, aes(area = n, subgroup = GENERO, fill = RACA), layout = "srow")+
  geom_treemap(lwd = 3)+
  geom_treemap_subgroup_border(lwd = 6, colour = "white")+
  geom_treemap_subgroup_text(
    colour = "white",
    family = "Fantasque",
    place = "bottom",
    fontface = "bold",
    grow = FALSE,
    size = 22
  )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(pcb, "Composição de sexo e raça dos candidatos em 2020",
                  sep = " - "),
    subtitle = "Área dos retângulos é proporcional à quantidade de candidatos",
    fill =  "Autodeclaração\nde cor ou raça"
  )+
  scale_fill_manual(
    values = c(pg_green, pg_blue, pg_orange),
    labels = c("Branca", "Parda", "Preta")
    )+
  theme_pindograma()+
  theme(axis.line.x = element_blank())
```

O PCB não elegeu ninguém em 2020. No entanto, podemos olhar os dados para os candidatos. O PCB é um dos poucos partidos que não teve candidatos nem indígenas nem asiáticos. A maioria ainda foi de brancos – 51,4%. Apenas 31,9% das candidatas eram mulheres.

---

#### Resultados em 2018

```{r, fig.height=7, fig.width=9}
depest <- eleicoes18 %>%
  filter(PARTIDO == party, CARGO == "DEPUTADO ESTADUAL") %>%
  group_by(UF) %>% mutate(n = n()) %>% ungroup() %>% 
  mutate(prop = n/BANCADA) %>% 
  right_join(geoloc_states, by = 'UF') %>% 
  mutate(eleitos = ifelse(is.na(CARGO), 0, prop)) %>% 
  distinct(UF, .keep_all = T)
ggplot(depest, aes(fill = prop))+
  geom_sf(aes(geometry = geom), lwd = .5)+
  scale_fill_fermenter(
    breaks = c(0.02, 0.06, 0.1, 0.14),
    palette = cor_continua, direction = 1,
    labels = scales::percent_format(accuracy = .1)
    )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party, "Tamanho da bancada no legislativo estadual\nEleição 2018",
                  sep = " - "),
    fill =  "Porcentagem da\nassembleia estadual"
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.background = element_blank()
  )
```

Como em outros casos, o Maranhão é o estado onde o PCdoB mais se destaca, com mais deputados que um partido tradicional como o DEM. Em seguida, o Acre e a Bahia são os outros estados com maior presença do partido no legislativo. Não há deputados estaduais do PCdoB no Centro-Oeste ou no Sul.

O PCB não possui deputados estaduais eleitos.

```{r, fig.height=7, fig.width=9}
depfed <- eleicoes18 %>%
  filter(PARTIDO == party, CARGO == "DEPUTADO FEDERAL") %>%
  group_by(UF) %>% mutate(n = n()) %>% ungroup() %>% 
  mutate(prop = n/BANCADA) %>% 
  right_join(geoloc_states, by = 'UF') %>% 
  mutate(eleitos = ifelse(is.na(CARGO), 0, prop)) %>% 
  distinct(UF, .keep_all = T)
ggplot(depfed, aes(fill = prop))+
  geom_sf(aes(geometry = geom), lwd = .5)+
  scale_fill_fermenter(
    labels = scales::percent_format(accuracy = 1),
    palette = cor_continua, direction = 1
    )+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party, "Proporção dos deputados federais\neleitos por estado em 2018",
                  sep = " - "),
    fill = "Porcentagem dos\ndeputados do estado"
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.background = element_blank()
  )
```

Assim como no caso dos deputados estaduais, o Maranhão tem uma bancada considerável do PCdoB no Congresso Nacional. A Bahia também tem mais de 10% de seus representantes do partido. O Acre e o Amapá elegeram um deputado cada do PCdoB, mas como têm apenas 8 deputados federais, a proporção fica no mesmo patamar do Maranhão.

O PCB teve membros na Câmara de Deputados apenas entre 1946 e 1948. 

O PCdoB não elegeu senadores nas últimas eleições e nenhum senador em exercício de mandato se filiou à legenda.

O único senador que o PCB elegeu na sua história foi Luís Carlos Prestes, em 1946.

```{r, fig.height=7, fig.width=9}
governadores <- eleicoes18 %>%
  filter(PARTIDO == party, CARGO == "GOVERNADOR") %>%
  right_join(geoloc_states, by = 'UF') %>% 
  mutate(dummy_gov = ifelse(is.na(CARGO), 0, 1))
ggplot(governadores, aes(fill = factor(dummy_gov, levels = c(1, 0))))+
  geom_sf(aes(geometry = geom), lwd = .5)+
  scale_fill_manual(values = c(cor, "grey90"))+
  annotate('text', label = 'Flávio Dino',
           family = 'Fantasque', color = "grey10",
           x = -35.5, y = -1, size = 3.5)+
  annotate('curve', curvature = .15, x = -39.5,
           xend = -42.5, y = -1, yend = -2.2,
           arrow = arrow(angle = 20, length = unit(.2, "cm")), size = .7,
           color = "grey30")+
  labs(
    caption = "Fonte: TSE",
    title = str_c(party,"Governadores eleitos em 2018",
                  sep = " - ")
  )+
  theme_pindograma()+
  theme(
    axis.line.x = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    panel.background = element_blank(),
    legend.position = "none"
  )
```

O Maranhão é o único estado governado pelo PCdoB atualmente. 

O PCB nunca elegeu governadores.

---

**Dados utilizados na matéria**: Filiados a partidos (Tribunal Superior
Eleitoral); Resultados eleições 2018 (TSE/Cepespdata); Candidatos eleições 2020
(TSE); Resultados eleições 2020 (TSE); IGPM (cortesia de Fernando Meireles, pacote deflateBR).

**Contribuiu com dados**: Antonio Piltcher.

**Créditos da imagem**: Marcos Oliveira/Agência Senado.

Para reproduzir os números citados, o código e os dados podem ser encontrados
[aqui][1].

[1]: https://github.com/pindograma/materias/blob/master/2020-11-28-pcbdob/pcbdob.Rmd
